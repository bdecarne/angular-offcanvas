angular.module("angular.offcanvas",[]),angular.module("angular.offcanvas").directive("offcanvasAnimationClass",function(){return{compile:function(a,e){e.offcanvasAnimation&&a.addClass(e.offcanvasAnimationClass)}}}),angular.module("angular.offcanvas").directive("offcanvasBackdrop",["$offcanvasStack","$timeout",function(a,e){function n(n,t,r){n.animate=!1,n.close=function(e){var n=a.getTop();n&&n.value.backdrop&&"static"!=n.value.backdrop&&e.target===e.currentTarget&&(e.preventDefault(),e.stopPropagation(),a.dismiss(n.key,"backdrop click"))},e(function(){n.animate=!0})}return{restrict:"EA",replace:!0,templateUrl:"templates/offcanvas/backdrop.html",compile:function(a,e){return a.addClass(e.backdropClass),n}}}]),angular.module("angular.offcanvas").directive("offcanvasPane",["$offcanvasStack","$q","$timeout","$window",function(a,e,n,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,e){return e.templateUrl||"templates/offcanvas/pane.html"},link:function(r,o,c){function s(){if("undefined"!=typeof jQuery&&jQuery.isFunction(jQuery.fn.nanoScroller)){var a=jQuery(".offcanvas-body",o);a.length||(a=jQuery(o).wrapInner('<div class="offcanvas-body"></div>'),a=jQuery(".offcanvas-body",o));var e=a.parent();e.hasClass("nano-content")===!1&&a.wrap('<div class="nano"><div class="nano-content"></div></div>');var n=t.innerHeight-jQuery(o).find(".nano").position().top,r=a.closest(".nano");r.css({height:n}),r.nanoScroller({preventPageScrolling:!0})}}o.addClass(c.paneClass||""),r.size=c.size,r.$isRendered=!0;var f=e.defer();c.$observe("offcanvasRender",function(a){"true"==a&&f.resolve()}),c.$observe("offcanvasSize",function(a){o.addClass(c.paneClass||"")}),f.promise.then(function(){n(function(){s(),r.animate=!0}),angular.element(t).bind("resize",function(){s()});var e=o[0].querySelectorAll("[autofocus]");e.length?e[0].focus():o[0].focus();var c=a.getTop();c&&a.offcanvasRendered(c.key)})}}}]),angular.module("angular.offcanvas").directive("offcanvasStack",["$timeout",function(a){function e(e,n,t){e.animate=!1,a(function(){e.animate=!0})}return{restrict:"EA",replace:!0,templateUrl:"templates/offcanvas/stack.html",compile:function(a,n){return a.addClass(n.stackClass),e}}}]),angular.module("angular.offcanvas").directive("offcanvasTransclude",function(){return{link:function(a,e,n,t,r){r(a.$parent,function(a){e.empty(),e.append(a)})}}}),angular.module("angular.offcanvas").factory("$offcanvasStack",["$animate","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,e,n,t,r,o){function c(){for(var a=-1,e=k.keys(),n=0;n<e.length;n++)k.get(e[n]).value.backdrop&&(a=n);return a}function s(a){var e=n.find("body").eq(0),t=k.get(a).value;k.remove(a),a.parent&&h.extend(a.parent),i(t.offcanvasDomEl,t.offcanvasScope,function(){e.toggleClass(m,k.length()>0),f()})}function f(){var a=n.find("body").eq(0);if(v&&-1==c()){var e=p;a.removeClass(g),i(v,p,function(){e=null}),v=void 0,p=void 0}}function i(n,t,o){function c(){c.done||(c.done=!0,n.remove(),t.$destroy(),o&&o())}t.animate=!1,n.attr("offcanvas-animation")&&a.enabled()?n.one("$animate:close",function(){r.$evalAsync(c)}):e(c)}function l(a,e,n){return!a.value.offcanvasScope.$broadcast("offcanvas.closing",e,n).defaultPrevented}var u,d,v,p,m="offcanvas-opened",g="offcanvas-with-backdrop",k=o.createNew(),h={};return r.$watch(c,function(a){p&&(p.index=a)}),n.bind("keydown",function(a){var e;27===a.which&&(e=k.top(),e&&e.value.keyboard&&(a.preventDefault(),r.$apply(function(){h.dismiss(e.key,"escape key press")})))}),h.open=function(a,o){k.add(a,{deferred:o.deferred,renderDeferred:o.renderDeferred,offcanvasScope:o.scope,backdrop:o.backdrop,keyboard:o.keyboard});var s=n.find("body").eq(0),f=c();if(f>=0&&!v){p=r.$new(!0),p.index=f;var i=angular.element('<div offcanvas-backdrop="offcanvas-backdrop"></div>');i.attr("backdrop-class",o.backdropClass),o.animation&&i.attr("offcanvas-animation","true"),v=t(i)(p),s.append(v),s.addClass(g)}if(!u){d=r.$new(!0);var l=angular.element('<div offcanvas-stack="offcanvas-stack"></div>');l.attr("stack-class",o.stackClass),u=t(l)(d),s.append(u)}var h=angular.element('<div offcanvas-pane="offcanvas-pane"></div>');h.attr({"template-url":o.paneTemplateUrl,"pane-class":o.paneClass,size:o.size,index:k.length()-1,animate:"animate"}).html(o.content),o.animation&&h.attr("offcanvas-animation","true");var $=t(h)(o.scope);k.top().value.offcanvasDomEl=$,e(function(){u.append($),s.addClass(m)})},h.close=function(a,e){var n=k.get(a);return n&&l(n,e,!0)?(n.value.deferred.resolve(e),s(a),!0):!n},h.dismiss=function(a,e){var n=k.get(a);return n&&l(n,e,!1)?(n.value.deferred.reject(e),s(a),!0):!n},h.reduce=function(a){var e=k.get(a);if(e){var n=e.value.offcanvasDomEl;n.removeClass("offcanvas-opened").addClass("offcanvas-reduced")}},h.extend=function(a){var e=k.get(a);if(e){var n=e.value.offcanvasDomEl;n.removeClass("offcanvas-reduced").addClass("offcanvas-opened")}},h.dismissAll=function(a){for(var e=this.getTop();e&&this.dismiss(e.key,a);)e=this.getTop()},h.getTop=function(){return k.top()},h.offcanvasRendered=function(a){var e=k.get(a);e&&e.value.renderDeferred.resolve()},h}]),angular.module("angular.offcanvas").provider("$offcanvas",function(){var a={options:{animation:!0,backdrop:!1,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$offcanvasStack",function(e,n,t,r,o,c,s){function f(a){return a.template?t.when(a.template):r.get(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl,{cache:o}).then(function(a){return a.data})}function i(a){var n=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&n.push(t.when(e.invoke(a)))}),n}var l={};return l.open=function(e){var r=t.defer(),o=t.defer(),l=t.defer(),u={result:r.promise,opened:o.promise,rendered:l.promise,close:function(a){return s.close(u,a)},dismiss:function(a){return s.dismiss(u,a)}};if(e.parent&&(u.parent=e.parent),e=angular.extend({},a.options,e),e.resolve=e.resolve||{},!e.template&&!e.templateUrl)throw new Error("One of template or templateUrl options is required.");var d=t.all([f(e)].concat(i(e.resolve)));return d.then(function(a){var t=(e.scope||n).$new();t.$close=u.close,t.$dismiss=u.dismiss;var o,f={},i=1;e.controller&&(f.$scope=t,f.$offcanvasInstance=u,angular.forEach(e.resolve,function(e,n){f[n]=a[i++]}),o=c(e.controller,f),e.controllerAs&&(t[e.controllerAs]=o)),u.parent?s.reduce(u.parent):s.dismissAll(),s.open(u,{scope:t,deferred:r,renderDeferred:l,content:a[0],parent:e.parent,animation:e.animation,backdrop:e.backdrop,keyboard:e.keyboard,backdropClass:e.backdropClass,paneClass:e.paneClass,paneTemplateUrl:e.paneTemplateUrl,size:e.size,target:e.target})},function(a){r.reject(a)}),d.then(function(){o.resolve(!0)},function(a){o.reject(a)}),u},l}]};return a}),angular.module("angular.offcanvas").factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(e,n){a.push({key:e,value:n})},get:function(e){for(var n=0;n<a.length;n++)if(e==a[n].key)return a[n]},keys:function(){for(var e=[],n=0;n<a.length;n++)e.push(a[n].key);return e},top:function(){return a[a.length-1]},remove:function(e){for(var n=-1,t=0;t<a.length;t++)if(e==a[t].key){n=t;break}return a.splice(n,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}),angular.module("angular.offcanvas").run(["$templateCache",function(a){a.put("templates/offcanvas/backdrop.html",'<div class="offcanvas-backdrop" offcanvas-animation-class="fade" ng-click="close($event)" ng-class="{in: animate}"></div>')}]),angular.module("angular.offcanvas").run(["$templateCache",function(a){a.put("templates/offcanvas/pane.html","<div offcanvas-render=\"{{$isRendered}}\" class=\"offcanvas-pane\" ng-class=\"[animate ? 'offcanvas-opened' : '', size ? 'width-' + size : 'width-8']\" offcanvas-transclude=\"\"></div>")}]),angular.module("angular.offcanvas").run(["$templateCache",function(a){a.put("templates/offcanvas/stack.html",'<div class="offcanvas"></div>')}]);